import{r as p,C as z,o as k,e as A,w as a,b as e,K as R,u as t,I as D,V as x,f as y,D as U,s as h,c as O,F as j,E as P,H,A as W,a as o,G as X,t as C}from"./main-BamGvAjg.js";import{r as S}from"./rules-B5G8qOzK.js";import{a as q,b as $,e as E,V as B,d as Y}from"./VTextField-1ys-liIu.js";import{V as L}from"./VForm-C_0S8g3K.js";import{V as N,a as w}from"./VRow-CS9fcrjS.js";import{V as J,a as Z}from"./VAutocomplete-CV-sKyN8.js";import{V as M}from"./VDivider-BVdfafVF.js";import{V as I}from"./VSpacer-5-XwI9bQ.js";import{V as F}from"./VDialog-CfWozT0b.js";import{V as ee,a as te,b as G}from"./VList-DyE5X8Dw.js";import{V as le}from"./VTable-SAWoljyi.js";import{V as ae}from"./VPagination-Csy0LPkf.js";import{V as se}from"./VSkeletonLoader-HKZIy6ej.js";import{V as oe}from"./VCheckbox-D0p3f3Zp.js";import"./forwardRefs-DUMsmNF6.js";import"./VImg-C3PmJxkR.js";/* empty css              */import"./dialog-transition-C_q3zPbm.js";import"./VOverlay-BSOkjb50.js";import"./lazy-D8v9bkkP.js";import"./VCheckboxBtn-CJx0AXnU.js";import"./VSelectionControl-Cb_evK1R.js";import"./ssrBoot-DWWf1isl.js";const K={__name:"additional_add",props:{title:String},emits:["close"],setup(T,{emit:_}){const g=T,n=_,f=p(),c=p({timesheet_id:null,fee:null,date:null}),v=p([]),u=p(!1),r=async()=>{u.value=!0;try{const d=await U.get("api/v1/timesheet/component/list");d&&(v.value=d)}catch(d){console.error(d)}finally{u.value=!1}},m=async()=>{var i,s;const d=g.title=="bonus"?"api/v1/payment/bonus/create":"api/v1/payment/additional-fee/create",{valid:V}=await f.value.validate();if(V)try{const l=await U.post(d,c.value);console.log(l),l&&h("success",l.message,"bottom-end")}catch(l){const b=(s=(i=l==null?void 0:l.response)==null?void 0:i.data)==null?void 0:s.errors;h("error",b,"bottom-end")}finally{n("close")}};return z(()=>{r()}),(d,V)=>(k(),A(B,{title:g.title=="bonus"?"Add Bonus":"Additional Fee"},{default:a(()=>[e(q,null,{default:a(()=>[e(L,{onSubmit:R(m,["prevent"]),ref_key:"formData",ref:f},{default:a(()=>[e(N,null,{default:a(()=>[e(w,{cols:"12"},{default:a(()=>[e(J,{modelValue:t(c).timesheet_id,"onUpdate:modelValue":V[0]||(V[0]=i=>t(c).timesheet_id=i),label:"Timesheet - Package",placeholder:"Timesheet - Package",items:t(v),"item-title":i=>i.package_type+" - "+i.package_name+" | "+i.clients,"item-value":"id",density:"compact",rules:t(S).required,loading:t(u),disabled:t(u)},null,8,["modelValue","items","item-title","rules","loading","disabled"])]),_:1}),e(w,{cols:"6"},{default:a(()=>[e($,{modelValue:t(c).date,"onUpdate:modelValue":V[1]||(V[1]=i=>t(c).date=i),type:"date",label:"Date",placeholder:"Date",density:"compact",rules:t(S).required},null,8,["modelValue","rules"])]),_:1}),e(w,{cols:"6"},{default:a(()=>[e($,{modelValue:t(c).fee,"onUpdate:modelValue":V[2]||(V[2]=i=>t(c).fee=i),type:"number",label:"Additional Fee",placeholder:"Additional Fee",density:"compact",rules:t(S).required},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(M,{class:"my-3"}),e(E,null,{default:a(()=>[e(D,{color:"error",onClick:V[3]||(V[3]=i=>n("close"))},{default:a(()=>[e(x,{icon:"ri-close-line",class:"me-3"}),y(" Close ")]),_:1}),e(I),e(D,{color:"success",type:"submit"},{default:a(()=>[y(" Save "),e(x,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["title"]))}},ne={__name:"cutoff_add",emits:["close","reload"],setup(T,{emit:_}){const g=_,n=p(),f=p({start_date:null,end_date:null}),c=async()=>{var u,r;const{valid:v}=await n.value.validate();if(v)try{const m=await U.post("api/v1/payment/cut-off/create",f.value);m&&h("success",m.message,"bottom-end")}catch(m){const d=(r=(u=m==null?void 0:m.response)==null?void 0:u.data)==null?void 0:r.errors;h("error",d,"bottom-end")}finally{g("close"),g("reload")}};return(v,u)=>(k(),A(B,{title:"Cut-Off Date"},{default:a(()=>[e(q,null,{default:a(()=>[e(L,{onSubmit:R(c,["prevent"]),ref_key:"formData",ref:n},{default:a(()=>[e(N,null,{default:a(()=>[e(w,{cols:"6"},{default:a(()=>[e($,{modelValue:t(f).start_date,"onUpdate:modelValue":u[0]||(u[0]=r=>t(f).start_date=r),type:"date",label:"Start Date",rules:t(S).required,placeholder:"Activity"},null,8,["modelValue","rules"])]),_:1}),e(w,{cols:"6"},{default:a(()=>[e($,{modelValue:t(f).end_date,"onUpdate:modelValue":u[1]||(u[1]=r=>t(f).end_date=r),type:"date",label:"End Date",rules:t(S).required,placeholder:"Activity"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(M,{class:"my-3"}),e(E,null,{default:a(()=>[e(D,{color:"error",onClick:u[2]||(u[2]=r=>g("close"))},{default:a(()=>[e(x,{icon:"ri-close-line",class:"me-3"}),y(" Close ")]),_:1}),e(I),e(D,{color:"success",type:"submit"},{default:a(()=>[y(" Save "),e(x,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}))}},re={__name:"cutoff_existing_add",props:{id:Array},emits:["close","reload","reset"],setup(T,{emit:_}){const g=T,n=_,f=p(),c=p({activity_id:g.id,start_date:null,end_date:null}),v=async()=>{var r,m;console.log(c);const{valid:u}=await f.value.validate();if(u)try{const d=await U.post("api/v1/payment/cut-off/add",c.value);d&&h("success",d.message,"bottom-end")}catch(d){if((m=(r=d==null?void 0:d.response)==null?void 0:r.data)!=null&&m.errors){const V=d.response.data.errors;let i="Validation errors:";for(const s in V)V.hasOwnProperty(s)&&(i+=`
${s}: ${V[s].join(", ")}`);h("error",i,"bottom-end")}}finally{n("reload"),n("close"),n("reset")}};return(u,r)=>(k(),A(B,{title:"Add to Cut-Off"},{default:a(()=>[e(q,null,{default:a(()=>[e(L,{onSubmit:R(v,["prevent"]),ref_key:"formData",ref:f},{default:a(()=>[e(N,null,{default:a(()=>[e(w,{cols:"6"},{default:a(()=>[e($,{modelValue:t(c).start_date,"onUpdate:modelValue":r[0]||(r[0]=m=>t(c).start_date=m),type:"date",label:"Start Date",density:"compact",rules:t(S).required},null,8,["modelValue","rules"])]),_:1}),e(w,{cols:"6"},{default:a(()=>[e($,{modelValue:t(c).end_date,"onUpdate:modelValue":r[1]||(r[1]=m=>t(c).end_date=m),type:"date",label:"End Date",density:"compact",rules:t(S).required},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(M,{class:"my-3"}),e(E,null,{default:a(()=>[e(D,{color:"error",onClick:r[2]||(r[2]=m=>n("close"))},{default:a(()=>[e(x,{icon:"ri-close-line",class:"me-3"}),y(" Close ")]),_:1}),e(I),e(D,{color:"success",type:"submit"},{default:a(()=>[y(" Save "),e(x,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}))}},de=o("div",{class:"d-flex justify-between align-center"},[o("div",{class:"w-100"},[o("h4",null,"Pre Cut-Off")])],-1),ie=o("thead",null,[o("tr",null,[o("th",{class:"text-uppercase",width:"1%"}," # "),o("th",{class:"text-uppercase",width:"1%"}," No "),o("th",{class:"text-uppercase text-center"},"Timesheet"),o("th",{class:"text-uppercase text-center"},"Activity"),o("th",{class:"text-uppercase text-center"},"Mentor/Tutor"),o("th",{class:"text-uppercase text-center"},"Date & Time"),o("th",{class:"text-uppercase text-center"},"Time Spent"),o("th",{class:"text-uppercase text-center"},"Fee/Hours"),o("th",{class:"text-uppercase text-center"},"Total"),o("th",{class:"text-uppercase text-center"},"Cut-Offf Status")])],-1),ue={class:"text-center"},ce={class:"d-flex justify-center mt-5"},Be={__name:"pre",setup(T){const _=p(!1),g=p([]),n=p({cut_off:!1,additional_fee:!1,add_bonus:!1,add_existing:!1}),f=p(1),c=p(),v=p([]),u=p(null),r=p(null),m=p([]),d=async()=>{_.value=!0;const i="?page="+f.value,s=u.value?"&keyword="+u.value:"",l=r.value?"&package_id="+r.value:"";try{const b=await U.get("api/v1/payment/unpaid"+i+s+l);b&&(f.value=b.current_page,c.value=b.last_page,g.value=b)}catch(b){console.error(b)}finally{_.value=!1}},V=async()=>{_.value=!0;try{const i=await U.get("api/v1/package/component/list");i&&(m.value=i,_.value=!1)}catch(i){_.value=!1,console.error(i)}};return z(()=>{d(),V()}),(i,s)=>(k(),O(j,null,[e(B,null,{default:a(()=>[e(Y,null,{default:a(()=>[de]),_:1}),e(q,null,{default:a(()=>[e(N,{class:"my-1"},{default:a(()=>[e(w,{cols:"3",md:"4"},{default:a(()=>[e(J,{loading:t(_),disabled:t(_),clearable:"true",label:"Package Name",items:t(m),"item-title":l=>l.type_of+" - "+l.package,"item-value":"id",modelValue:t(r),"onUpdate:modelValue":[s[0]||(s[0]=l=>P(r)?r.value=l:null),d],placeholder:"Select Timesheet Package",density:"compact"},null,8,["loading","disabled","items","item-title","modelValue"])]),_:1}),e(w,{cols:"3",md:"3"},{default:a(()=>[e($,{loading:t(_),disabled:t(_),"append-inner-icon":"ri-search-line",density:"compact",label:"Search",variant:"solo","hide-details":"","single-line":"",modelValue:t(u),"onUpdate:modelValue":s[1]||(s[1]=l=>P(u)?u.value=l:null),onChange:d},null,8,["loading","disabled","modelValue"])]),_:1}),e(w,{cols:"6",md:"5",class:"text-end"},{default:a(()=>[t(v).length>0?(k(),A(D,{key:0,color:"warning",density:"compact",class:"me-1",onClick:s[2]||(s[2]=l=>t(n).add_existing=!0)},{default:a(()=>[e(x,{icon:"ri-add-box-line",class:"me-2"}),y(" Add to Existing Cut-Off ")]),_:1})):H("",!0),e(ee,{"close-on-content-click":!1,location:"bottom"},{activator:a(({props:l})=>[e(D,W({density:"compact",color:"light-primary"},l,{class:"me-1"}),{default:a(()=>[y(" Additional Fee "),e(x,{icon:"ri-arrow-down-s-line",class:"ms-2"})]),_:2},1040)]),default:a(()=>[e(te,null,{default:a(()=>[e(G,null,{default:a(()=>[o("div",{class:"cursor-pointer",onClick:s[3]||(s[3]=l=>t(n).additional_fee=!0)},[e(x,{icon:"ri-wallet-2-line",class:"me-2"}),y(" Additional Fee ")])]),_:1}),e(G,null,{default:a(()=>[o("div",{class:"cursor-pointer",onClick:s[4]||(s[4]=l=>t(n).add_bonus=!0)},[e(x,{icon:"ri-wallet-3-line",class:"me-2"}),y(" Add Bonus ")])]),_:1})]),_:1})]),_:1}),t(v).length==0?(k(),A(D,{key:1,color:"secondary",density:"compact",onClick:s[5]||(s[5]=l=>t(n).cut_off=!0)},{default:a(()=>[e(x,{icon:"ri-scissors-cut-line",class:"me-2"}),y(" Cut-Off ")]),_:1})):H("",!0)]),_:1})]),_:1}),t(_)?(k(),A(se,{key:0,class:"mx-auto border",type:"table-thead, table-row@10"})):(k(),A(le,{key:1,class:"text-no-wrap"},{default:a(()=>[ie,o("tbody",null,[(k(!0),O(j,null,X(t(g).data,(l,b)=>(k(),O("tr",{key:b},[o("td",null,[e(oe,{modelValue:t(v),"onUpdate:modelValue":s[6]||(s[6]=Q=>P(v)?v.value=Q:null),value:l.id},null,8,["modelValue","value"])]),o("td",null,C(parseInt(b)+1),1),o("td",null,C(l.package.type+" - "+l.package.name),1),o("td",null,C(l.activity),1),o("td",null,C(l.mentor_tutor),1),o("td",null,C(l.date),1),o("td",null,C(l.time_spent/60+" Hours"),1),o("td",null,"Rp. "+C(l.fee_hours),1),o("td",null," Rp. "+C(l.time_spent/60*l.fee_hours),1),o("td",ue,[e(Z,{color:l.cutoff_status=="not yet"?"#ff0217":"#91c45e"},{default:a(()=>[y(C(l.cutoff_status.charAt(0).toUpperCase()+l.cutoff_status.slice(1).toLowerCase()),1)]),_:2},1032,["color"])])]))),128))])]),_:1})),o("div",ce,[e(ae,{modelValue:t(f),"onUpdate:modelValue":[s[7]||(s[7]=l=>P(f)?f.value=l:null),d],length:t(c),"total-visible":4,color:"primary",density:"compact","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1}),e(F,{modelValue:t(n).cut_off,"onUpdate:modelValue":s[9]||(s[9]=l=>t(n).cut_off=l),"max-width":"450",persistent:""},{default:a(()=>[e(ne,{onClose:s[8]||(s[8]=l=>t(n).cut_off=!1),onReload:d})]),_:1},8,["modelValue"]),e(F,{modelValue:t(n).add_existing,"onUpdate:modelValue":s[12]||(s[12]=l=>t(n).add_existing=l),"max-width":"450",persistent:"",scrollable:""},{default:a(()=>[e(re,{id:t(v),onClose:s[10]||(s[10]=l=>t(n).add_existing=!1),onReload:d,onReset:s[11]||(s[11]=l=>v.value=[])},null,8,["id"])]),_:1},8,["modelValue"])]),_:1}),e(F,{modelValue:t(n).add_bonus,"onUpdate:modelValue":s[14]||(s[14]=l=>t(n).add_bonus=l),"max-width":"450",persistent:""},{default:a(()=>[e(K,{title:"bonus",onClose:s[13]||(s[13]=l=>t(n).add_bonus=!1)})]),_:1},8,["modelValue"]),e(F,{modelValue:t(n).additional_fee,"onUpdate:modelValue":s[16]||(s[16]=l=>t(n).additional_fee=l),"max-width":"450",persistent:""},{default:a(()=>[e(K,{title:"fee",onClose:s[15]||(s[15]=l=>t(n).additional_fee=!1)})]),_:1},8,["modelValue"])],64))}};export{Be as default};
