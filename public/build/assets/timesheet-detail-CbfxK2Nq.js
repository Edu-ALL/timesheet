import{r as D,l as E,o as _,f as k,w as s,b as t,Z as Q,W as q,u as l,v as R,Y as B,V as y,j as b,m as ee,A as P,s as C,$ as I,e as Z,a as e,x as j,h as H,c as S,X as K,F as J,t as m,y as te,a0 as le,k as se,a3 as W}from"./main-C002U57B.js";import{_ as ae}from"./DeleteHandler.vue_vue_type_script_setup_true_lang-CcECsiY4.js";import{d as oe}from"./debounce-D7WVAcMr.js";import{r as F}from"./rules-B5G8qOzK.js";import{a as w,c as ne,V as Y,b as A,d as z}from"./VCard-CKDa0iFw.js";import{V as ie}from"./VForm-BQTO7cwR.js";import{V as O,a as V}from"./VRow-4G1TTMrp.js";import{V as de}from"./VTextarea-DGT0TEro.js";import{V as X}from"./VDialog-Bb4XgRw8.js";import{a as G,V as U}from"./VTable-Kw-0VFsm.js";import{T as L}from"./index-_N5cN1fU.js";import{V as re}from"./VCheckbox-DoTNVXkE.js";import"./VAvatar-DAYJWZge.js";import"./VImg-DFit4D-2.js";import"./VTooltip-bPnnBUJ4.js";import"./VCheckboxBtn-BZV4pXrk.js";import"./VSelectionControl-DJ65p_9P.js";const ce={__name:"activity-add",props:{id:String},emits:["close","reload"],setup(M,{emit:p}){const x=M,f=p,c=D(),i=D({activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}),T=async()=>{var o,g;const{valid:h}=await c.value.validate();if(h)try{const n=await P.post("api/v1/timesheet/"+x.id+"/activity",i.value);n&&C("success",n.message,"bottom-end")}catch(n){if((g=(o=n==null?void 0:n.response)==null?void 0:o.data)!=null&&g.errors){const a=n.response.data.errors;let v="Validation errors:";for(const d in a)a.hasOwnProperty(d)&&(v+=`
${d}: ${a[d].join(", ")}`);C("error",v,"bottom-end")}else C("error",n.response.data.message,"bottom-end")}finally{f("reload"),f("close")}};return(h,o)=>{const g=E("DialogCloseBtn"),n=E("VDateInput");return _(),k(Y,{title:"New Activity"},{default:s(()=>[t(g,{variant:"text",size:"default",onClick:o[0]||(o[0]=a=>f("close"))}),t(w,null,{default:s(()=>[t(ie,{onSubmit:Q(T,["prevent"]),ref_key:"formData",ref:c,"validate-on":"input"},{default:s(()=>[t(O,null,{default:s(()=>[t(V,{cols:"12",class:"d-none"},{default:s(()=>[t(q,{modelValue:l(i).activity,"onUpdate:modelValue":o[1]||(o[1]=a=>l(i).activity=a),label:"Activity Name",placeholder:"Activity",variant:"solo"},null,8,["modelValue"])]),_:1}),t(V,{cols:"12"},{default:s(()=>[t(de,{modelValue:l(i).description,"onUpdate:modelValue":o[2]||(o[2]=a=>l(i).description=a),label:"Meeting Discussion",placeholder:"Meeting Discussion",variant:"solo",rules:l(F).required},null,8,["modelValue","rules"])]),_:1}),t(V,{md:"6",cols:"12"},{default:s(()=>[t(n,{modelValue:l(i).date,"onUpdate:modelValue":o[3]||(o[3]=a=>l(i).date=a),label:"Date",placeholder:"Select Date","prepend-icon":"",variant:"solo",rules:l(F).required},null,8,["modelValue","rules"])]),_:1}),t(V,{md:"3",cols:"6"},{default:s(()=>[t(q,{type:"time",modelValue:l(i).start_time,"onUpdate:modelValue":o[4]||(o[4]=a=>l(i).start_time=a),label:"Start Time",placeholder:"Start Time",rules:l(F).required,variant:"solo",class:"mb-3",onChange:o[5]||(o[5]=a=>l(i).start_date=l(R)(l(i).date).format("YYYY-MM-DD")+" "+l(i).start_time+":00")},null,8,["modelValue","rules"])]),_:1}),t(V,{md:"3",cols:"6"},{default:s(()=>[t(q,{type:"time",modelValue:l(i).end_time,"onUpdate:modelValue":o[6]||(o[6]=a=>l(i).end_time=a),label:"End Time",placeholder:"End Time",variant:"solo",onChange:o[7]||(o[7]=a=>l(i).end_date=l(R)(l(i).date).format("YYYY-MM-DD")+" "+l(i).end_time+":00")},null,8,["modelValue"])]),_:1}),t(V,{md:"12",cols:"12"},{default:s(()=>[t(q,{type:"text",modelValue:l(i).meeting_link,"onUpdate:modelValue":o[8]||(o[8]=a=>l(i).meeting_link=a),label:"Meeting Link",placeholder:"Meeting Link",variant:"solo",rules:l(F).url},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(ne,{class:"mt-5"},{default:s(()=>[t(B,{type:"button",color:"error",onClick:o[9]||(o[9]=a=>f("close"))},{default:s(()=>[t(y,{icon:"ri-close-line",class:"me-3"}),b(" Close ")]),_:1}),t(ee),t(B,{type:"submit",color:"success"},{default:s(()=>[b(" Save "),t(y,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}},ue={class:"d-flex justify-between align-center"},me=e("div",{class:"w-100"},[e("h4",null,"Activity")],-1),_e=e("thead",null,[e("tr",null,[e("th",{class:"text-uppercase",width:"1%"}," No "),e("th",{class:"text-uppercase text-center"},"Meeting Discussion"),e("th",{class:"text-uppercase text-center"},"Date"),e("th",{class:"text-uppercase text-center"},"Start Time"),e("th",{class:"text-uppercase text-center",style:{width:"200px !important"}}," End Time "),e("th",{class:"text-uppercase text-center"},"Time Spent"),e("th",{class:"text-uppercase text-center"},"Status"),e("th",{class:"text-uppercase text-end"},"#")])],-1),pe={width:"1%"},fe={class:"text-start"},he={class:"text-center"},ge={class:"text-start"},ve=["onUpdate:modelValue","onChange","disabled"],ye={class:"text-center"},xe={class:"text-end"},Ve=["href"],we={__name:"timesheet-detail",props:{id:String,require:String},setup(M){const p=M,x=I("updateReload"),f=D([]),c=D(!1),i=D([{add:!1,delete:!1}]),T=D([]),h=async()=>{c.value=!0;try{const d=await P.get("api/v1/timesheet/"+p.id+"/activities");d&&(f.value=d)}catch(d){console.error(d)}finally{c.value=!1}},o=d=>{i.value[d]?i.value[d]=!1:i.value[d]=!0},g=(d,u)=>{T.value=u,o(d)},n=async()=>{var d,u,r;try{const $=await P.delete("api/v1/timesheet/"+p.id+"/activity/"+T.value.id);$&&(C("success",$.message,"bottom-end"),o("delete"))}catch($){((d=$.response)==null?void 0:d.status)==400&&C("error",(r=(u=$.response)==null?void 0:u.data)==null?void 0:r.errors,"bottom-end")}finally{h(),x(!0)}},a=oe(async d=>{d.end_date=d.date+" "+d.end_time+":00";try{const u=await P.put("api/v1/timesheet/"+p.id+"/activity/"+d.id,d);u&&C("success",u.message,"bottom-end")}catch(u){console.error(u)}finally{h(),x(!0)}},500),v=async d=>{try{const u=await P.put("api/v1/timesheet/"+p.id+"/activity/"+d.id,d);u&&C("success",u.message,"bottom-end")}catch(u){console.error(u)}finally{h(),x(!0)}};return Z(()=>{h()}),(d,u)=>(_(),k(Y,null,{default:s(()=>[t(A,null,{default:s(()=>[e("div",ue,[me,p.require=="mentor"?j((_(),k(B,{key:0,onClick:u[0]||(u[0]=r=>o("add"))},{default:s(()=>[t(y,{icon:"ri-add-line"})]),_:1})),[[L,"New Activity","start"]]):H("",!0),t(X,{modelValue:l(i).add,"onUpdate:modelValue":u[2]||(u[2]=r=>l(i).add=r),"max-width":"600",persistent:""},{default:s(()=>[t(ce,{id:p.id,onClose:u[1]||(u[1]=r=>o("add")),onReload:h},null,8,["id"])]),_:1},8,["modelValue"])])]),_:1}),t(w,null,{default:s(()=>[l(c)?(_(),k(U,{key:1,type:"table"})):(_(),k(G,{key:0,class:"text-no-wrap",height:"400","fixed-header":""},{default:s(()=>[_e,e("tbody",null,[(_(!0),S(J,null,K(l(f),(r,$)=>(_(),S("tr",{key:$},[e("td",pe,m($+1),1),e("td",fe,m(r.description),1),e("td",null,m(d.$moment(r.start_date).format("dddd"))+", "+m(d.$moment(r.start_date).format("MMM Do YYYY")),1),e("td",he,m(r.start_time),1),e("td",ge,[j(e("input",{type:"time",class:"form-control px-2 py-2 border rounded cursor-pointer","onUpdate:modelValue":N=>r.end_time=N,onChange:N=>l(a)(r),disabled:r.start_time=="00:00"||r.cutoff_status=="completed"},null,40,ve),[[te,r.end_time],[L,r.cutoff_status=="completed"?"Already Cut-Off":"End Time","start"]])]),e("td",ye,m(r.estimate)+" Minutes",1),e("td",null,[j(t(re,{color:"success",modelValue:r.status,"onUpdate:modelValue":[N=>r.status=N,N=>v(r)],value:"1","false-value":0,disabled:r.start_time=="00:00"||r.cutoff_status=="completed"},null,8,["modelValue","onUpdate:modelValue","disabled"]),[[L,r.status?"Completed":"Not Yet","start"]])]),e("td",xe,[t(B,{color:"primary",density:"compact",class:"me-1"},{default:s(()=>[e("a",{href:r.meeting_link,target:"_blank",class:"bg-primary"},[t(y,{icon:"ri ri-link"}),b(" Join ")],8,Ve)]),_:2},1024),j((_(),k(B,{color:"error",density:"compact",disabled:r.start_time=="00:00"||r.cutoff_status=="completed",onClick:N=>g("delete",r)},{default:s(()=>[t(y,{icon:"ri-delete-bin-line",class:"cursor-pointer"})]),_:2},1032,["disabled","onClick"])),[[L,r.status?"Already Cut-Off":"Delete Activity","start"]])])]))),128))])]),_:1}))]),_:1}),t(X,{modelValue:l(i).delete,"onUpdate:modelValue":u[4]||(u[4]=r=>l(i).delete=r),"max-width":"400",persistent:""},{default:s(()=>[t(ae,{title:"activity",onClose:u[3]||(u[3]=r=>o("delete")),onDelete:n})]),_:1},8,["modelValue"])]),_:1}))}},be={class:"w-100"},ke={class:"mt-3 font-weight-light"},De=e("hr",{class:"my-2"},null,-1),$e={key:0},Ce=e("tr",{class:"bg-secondary"},[e("td",null,"Name"),e("td",null,"School"),e("td",null,"Grade")],-1),Me={key:1},Te=e("td",{width:"20%"},"Name",-1),Se=e("td",{width:"1%"},":",-1),Ne=e("td",null,"School Name",-1),Pe=e("td",{width:"1%"},":",-1),Ye=e("td",null,"Grade",-1),Ae=e("td",{width:"1%"},":",-1),Ue=e("td",null,"Email",-1),Be=e("td",{width:"1%"},":",-1),qe={class:"mt-5 font-weight-light"},je=e("hr",{class:"my-2"},null,-1),Fe=e("td",{width:"20%"},"Program",-1),Le=e("td",{width:"1%"},":",-1),ze=e("td",null,"Package",-1),Ee=e("td",{width:"1%"},":",-1),Re=e("td",null,"Person in Charge",-1),Ie=e("td",{width:"1%"},":",-1),Oe={class:"ms-4",type:"1"},Ge=e("td",null,"Tutor/Mentor",-1),Je=e("td",{width:"1%"},":",-1),We=e("td",null,"Update On",-1),Xe=e("td",{width:"1%"},":",-1),Ze={class:"d-flex align-end w-100"},He={class:"m-0 mb-1 text-white"},Ke=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),Qe={class:"text-end w-100"},et={class:"d-flex align-end w-100"},tt={class:"m-0 mb-1 text-white"},lt=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),st={class:"text-end w-100"},at={class:"d-flex align-end w-100"},ot={class:"m-0 mb-1 text-white"},nt=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),it={class:"text-end w-100"},dt={__name:"user-detail",props:{id:String},setup(M){const p=M,x=I("reloadData"),f=I("updateReload"),c=D([]),i=D(!1),T=async h=>{var o,g,n;i.value=!0;try{const a=await P.get("api/v1/timesheet/"+h+"/detail");a&&(c.value=a)}catch(a){((o=a.response)==null?void 0:o.status)==400&&(C("error",(n=(g=a.response)==null?void 0:g.data)==null?void 0:n.errors,"bottom-end"),se.push("/admin/timesheet")),console.log(a)}finally{i.value=!1}};return Z(()=>{T(p.id)}),le(()=>{x.value&&(T(p.id),f(!1))}),(h,o)=>{const g=E("router-link");return _(),k(Y,{class:"mb-3"},{default:s(()=>[t(A,{class:"d-flex justify-between align-center"},{default:s(()=>{var n;return[e("div",be,[t(g,{to:"/user/timesheet"},{default:s(()=>[t(y,{icon:"ri-arrow-left-line",color:"secondary",class:"me-2",size:"25"})]),_:1}),b(" Timesheet - "+m((n=l(c).packageDetails)==null?void 0:n.package_type),1)])]}),_:1}),t(w,null,{default:s(()=>[l(i)?(_(),k(O,{key:1},{default:s(()=>[t(V,{md:"7"},{default:s(()=>[t(U,{type:"heading, paragraph, heading, paragraph",class:"mb-3"})]),_:1}),t(V,{md:"5"},{default:s(()=>[t(U,{type:"text@3",color:"#16B1FF",class:"mb-3"}),t(U,{type:"text@3",color:"#91c45e",class:"mb-3"}),t(U,{type:"text@3",color:"#e05e5e",class:"mb-3"})]),_:1})]),_:1})):(_(),k(O,{key:0,align:"center"},{default:s(()=>[t(V,{md:"7"},{default:s(()=>[e("h4",ke,[t(y,{icon:"ri-user-line",size:"17",class:"me-2"}),b(" Basic Profile ")]),De,t(G,{density:"compact"},{default:s(()=>{var n,a;return[((n=l(c).clientProfile)==null?void 0:n.length)>1?(_(),S("tbody",$e,[Ce,(_(!0),S(J,null,K(l(c).clientProfile,v=>(_(),S("tr",null,[e("td",null,m(v.client_name),1),e("td",null,m(v.client_school),1),e("td",null,m(v.client_grade),1)]))),256))])):((a=l(c).clientProfile)==null?void 0:a.length)==1?(_(),S("tbody",Me,[e("tr",null,[Te,Se,e("td",null,m(l(c).clientProfile[0].client_name),1)]),e("tr",null,[Ne,Pe,e("td",null,m(l(c).clientProfile[0].client_school),1)]),e("tr",null,[Ye,Ae,e("td",null,m(l(c).clientProfile[0].client_grade),1)]),e("tr",null,[Ue,Be,e("td",null,m(l(c).clientProfile[0].client_mail),1)])])):H("",!0)]}),_:1}),e("h4",qe,[t(y,{icon:"ri-bookmark-line",class:"me-2",size:"17"}),b(" Package Details ")]),je,t(G,{density:"compact"},{default:s(()=>{var n,a,v,d,u;return[e("tbody",null,[e("tr",null,[Fe,Le,e("td",null,m((n=l(c).packageDetails)==null?void 0:n.program_name),1)]),e("tr",null,[ze,Ee,e("td",null,m(((a=l(c).packageDetails)==null?void 0:a.package_type)+" - "+((v=l(c).packageDetails)==null?void 0:v.package_name)),1)]),e("tr",null,[Re,Ie,e("td",null,[e("ol",Oe,[e("li",null,m((d=l(c).packageDetails)==null?void 0:d.pic_name),1)])])]),e("tr",null,[Ge,Je,e("td",null,m((u=l(c).packageDetails)==null?void 0:u.tutormentor_name),1)]),e("tr",null,[We,Xe,e("td",null,m(l(R)().format("LLL")),1)])])]}),_:1})]),_:1}),t(V,{md:"5"},{default:s(()=>[t(Y,{color:"#16B1FF",class:"mb-2 d-flex align-center"},{default:s(()=>[e("div",null,[t(z,null,{default:s(()=>[t(A,{class:"text-white"},{default:s(()=>[b(" Total Minutes of Package ")]),_:1})]),_:1}),t(w,{class:"d-flex justify-between"},{default:s(()=>{var n;return[e("div",Ze,[e("h1",He,m((n=l(c).packageDetails)==null?void 0:n.duration_in_minutes),1),Ke])]}),_:1})]),t(w,null,{default:s(()=>[e("div",Qe,[t(y,{icon:"ri-calendar-schedule-line",size:"60"})])]),_:1})]),_:1}),t(Y,{color:"#91c45e",class:"mb-2 d-flex align-center"},{default:s(()=>[e("div",null,[t(z,null,{default:s(()=>[t(A,{class:"text-white"},{default:s(()=>[b(" Total Minutes Spent ")]),_:1})]),_:1}),t(w,{class:"d-flex justify-between"},{default:s(()=>{var n;return[e("div",et,[e("h1",tt,m((n=l(c).packageDetails)==null?void 0:n.time_spent_in_minutes),1),lt])]}),_:1})]),t(w,null,{default:s(()=>[e("div",st,[t(y,{icon:"ri-timer-flash-line",size:"60",color:"white"})])]),_:1})]),_:1}),t(Y,{color:"#e05e5e",class:"mb-2 d-flex align-center"},{default:s(()=>[e("div",null,[t(z,null,{default:s(()=>[t(A,{class:"text-white"},{default:s(()=>[b(" Total Minutes Left ")]),_:1})]),_:1}),t(w,{class:"d-flex justify-between"},{default:s(()=>{var n,a;return[e("div",at,[e("h1",ot,m(((n=l(c).packageDetails)==null?void 0:n.duration_in_minutes)-((a=l(c).packageDetails)==null?void 0:a.time_spent_in_minutes)),1),nt])]}),_:1})]),t(w,null,{default:s(()=>[e("div",it,[t(y,{icon:"ri-timer-2-line",size:"60"})])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1})}}},$t={__name:"timesheet-detail",props:{id:Number,require:String},setup(M){const p=M,x=p.id,f=D(!1);return W("reloadData",f),W("updateReload",c=>{f.value=c}),(c,i)=>(_(),S(J,null,[t(dt,{id:l(x)},null,8,["id"]),t(we,{id:l(x),require:p.require},null,8,["id","require"])],64))}};export{$t as default};
