import{r as $,l as R,o as m,f as D,w as s,b as t,Z as Q,W as j,u as l,v as I,Y as z,V as g,j as x,m as ee,A,s as T,$ as O,e as H,a as e,x as F,h as U,c as b,X as K,F as W,t as _,y as te,a0 as le,k as se,a3 as X}from"./main-BnUI2Chz.js";import{_ as ae}from"./DeleteHandler.vue_vue_type_script_setup_true_lang-DwIlm8KW.js";import{d as oe}from"./debounce-tI2l7_MG.js";import{r as Y}from"./rules-B5G8qOzK.js";import{a as k,c as ne,V as P,b as q,d as E}from"./VCard-qxlU1t6w.js";import{V as ie}from"./VForm-DobfVYAA.js";import{V as G,a as w}from"./VRow-BkiGOIgS.js";import{V as de}from"./VTextarea-C_UPrvV6.js";import{V as Z}from"./VDialog-sWxZJlvP.js";import{a as J,V as B}from"./VTable-D2bZ-V8h.js";import{T as L}from"./index-C-sAldan.js";import{V as re}from"./VCheckbox-BGk0zXIk.js";import"./VAvatar-EbP5RMBl.js";import"./VImg-BmlavG2q.js";import"./VTooltip-BQDYgZUk.js";import"./VCheckboxBtn-DvOdS_5P.js";import"./VSelectionControl-Dz0wXcjS.js";const ce={__name:"activity-add",props:{id:String},emits:["close","reload"],setup(M,{emit:p}){const V=M,f=p,c=$(),d=$({activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}),S=async()=>{var o,v;const{valid:h}=await c.value.validate();if(h)try{const n=await A.post("api/v1/timesheet/"+V.id+"/activity",d.value);n&&T("success",n.message,"bottom-end")}catch(n){if((v=(o=n==null?void 0:n.response)==null?void 0:o.data)!=null&&v.errors){const a=n.response.data.errors;let y="Validation errors:";for(const r in a)a.hasOwnProperty(r)&&(y+=`
${r}: ${a[r].join(", ")}`);T("error",y,"bottom-end")}else T("error",n.response.data.message,"bottom-end")}finally{f("reload"),f("close")}};return(h,o)=>{const v=R("DialogCloseBtn"),n=R("VDateInput");return m(),D(P,{title:"New Activity"},{default:s(()=>[t(v,{variant:"text",size:"default",onClick:o[0]||(o[0]=a=>f("close"))}),t(k,null,{default:s(()=>[t(ie,{onSubmit:Q(S,["prevent"]),ref_key:"formData",ref:c,"validate-on":"input"},{default:s(()=>[t(G,null,{default:s(()=>[t(w,{cols:"12"},{default:s(()=>[t(j,{modelValue:l(d).activity,"onUpdate:modelValue":o[1]||(o[1]=a=>l(d).activity=a),label:"Activity Name",placeholder:"Activity",variant:"solo",rules:l(Y).required},null,8,["modelValue","rules"])]),_:1}),t(w,{cols:"12"},{default:s(()=>[t(de,{modelValue:l(d).description,"onUpdate:modelValue":o[2]||(o[2]=a=>l(d).description=a),label:"Description",placeholder:"Description",variant:"solo",rules:l(Y).required},null,8,["modelValue","rules"])]),_:1}),t(w,{md:"6",cols:"12"},{default:s(()=>[t(n,{modelValue:l(d).date,"onUpdate:modelValue":o[3]||(o[3]=a=>l(d).date=a),label:"Date",placeholder:"Select Date","prepend-icon":"",variant:"solo",rules:l(Y).required},null,8,["modelValue","rules"])]),_:1}),t(w,{md:"3",cols:"6"},{default:s(()=>[t(j,{type:"time",modelValue:l(d).start_time,"onUpdate:modelValue":o[4]||(o[4]=a=>l(d).start_time=a),label:"Start Time",placeholder:"Start Time",rules:l(Y).required,variant:"solo",class:"mb-3",onChange:o[5]||(o[5]=a=>l(d).start_date=l(I)(l(d).date).format("YYYY-MM-DD")+" "+l(d).start_time+":00")},null,8,["modelValue","rules"])]),_:1}),t(w,{md:"3",cols:"6"},{default:s(()=>[t(j,{type:"time",modelValue:l(d).end_time,"onUpdate:modelValue":o[6]||(o[6]=a=>l(d).end_time=a),label:"End Time",placeholder:"End Time",variant:"solo",onChange:o[7]||(o[7]=a=>l(d).end_date=l(I)(l(d).date).format("YYYY-MM-DD")+" "+l(d).end_time+":00")},null,8,["modelValue"])]),_:1}),t(w,{md:"12",cols:"12"},{default:s(()=>[t(j,{type:"text",modelValue:l(d).meeting_link,"onUpdate:modelValue":o[8]||(o[8]=a=>l(d).meeting_link=a),label:"Meeting Link",placeholder:"Meeting Link",variant:"solo",rules:l(Y).url},null,8,["modelValue","rules"])]),_:1})]),_:1}),t(ne,{class:"mt-5"},{default:s(()=>[t(z,{type:"button",color:"error",onClick:o[9]||(o[9]=a=>f("close"))},{default:s(()=>[t(g,{icon:"ri-close-line",class:"me-3"}),x(" Close ")]),_:1}),t(ee),t(z,{type:"submit",color:"success"},{default:s(()=>[x(" Save "),t(g,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}},ue={class:"d-flex justify-between align-center"},_e=e("div",{class:"w-100"},[e("h4",null,"Activity")],-1),me=e("th",{class:"text-uppercase",width:"1%"}," No ",-1),pe=e("th",{class:"text-uppercase text-center"},"Activity",-1),fe=e("th",{class:"text-uppercase text-center"},"Description",-1),he=e("th",{class:"text-uppercase text-center"},"Date",-1),ve=e("th",{class:"text-uppercase text-center"},"Start Time",-1),ye=e("th",{class:"text-uppercase text-center",style:{width:"200px !important"}}," End Time ",-1),ge=e("th",{class:"text-uppercase text-center"},"Time Spent",-1),xe=e("th",{class:"text-uppercase text-center"},"Status",-1),Ve={key:0,class:"text-uppercase text-end"},we={width:"1%"},be={key:0},ke=["href"],De={class:"text-start"},$e={class:"text-center"},Ce={class:"text-start"},Te=["onUpdate:modelValue","onChange","disabled"],Me={class:"text-center"},Se={key:0,class:"text-end"},Ne={__name:"timesheet-detail",props:{id:String,require:String},setup(M){const p=M,V=O("updateReload"),f=$([]),c=$(!1),d=$([{add:!1,delete:!1}]),S=$([]),h=async()=>{c.value=!0;try{const r=await A.get("api/v1/timesheet/"+p.id+"/activities");r&&(f.value=r)}catch(r){console.error(r)}finally{c.value=!1}},o=r=>{d.value[r]?d.value[r]=!1:d.value[r]=!0},v=(r,u)=>{S.value=u,o(r)},n=async()=>{var r,u,i;try{const C=await A.delete("api/v1/timesheet/"+p.id+"/activity/"+S.value.id);C&&(T("success",C.message,"bottom-end"),o("delete"))}catch(C){((r=C.response)==null?void 0:r.status)==400&&T("error",(i=(u=C.response)==null?void 0:u.data)==null?void 0:i.errors,"bottom-end")}finally{h(),V(!0)}},a=oe(async r=>{r.end_date=r.date+" "+r.end_time+":00";try{const u=await A.put("api/v1/timesheet/"+p.id+"/activity/"+r.id,r);u&&T("success",u.message,"bottom-end")}catch(u){console.error(u)}finally{h(),V(!0)}},500),y=async r=>{try{const u=await A.put("api/v1/timesheet/"+p.id+"/activity/"+r.id,r);u&&T("success",u.message,"bottom-end")}catch(u){console.error(u)}finally{h(),V(!0)}};return H(()=>{h()}),(r,u)=>(m(),D(P,null,{default:s(()=>[t(q,null,{default:s(()=>[e("div",ue,[_e,p.require=="mentor"?F((m(),D(z,{key:0,onClick:u[0]||(u[0]=i=>o("add"))},{default:s(()=>[t(g,{icon:"ri-add-line"})]),_:1})),[[L,"New Activity","start"]]):U("",!0),t(Z,{modelValue:l(d).add,"onUpdate:modelValue":u[2]||(u[2]=i=>l(d).add=i),"max-width":"600",persistent:""},{default:s(()=>[t(ce,{id:p.id,onClose:u[1]||(u[1]=i=>o("add")),onReload:h},null,8,["id"])]),_:1},8,["modelValue"])])]),_:1}),t(k,null,{default:s(()=>[l(c)?(m(),D(B,{key:1,type:"table"})):(m(),D(J,{key:0,class:"text-no-wrap",height:"400","fixed-header":""},{default:s(()=>[e("thead",null,[e("tr",null,[me,pe,fe,he,ve,ye,ge,xe,p.require=="mentor"?(m(),b("th",Ve," # ")):U("",!0)])]),e("tbody",null,[(m(!0),b(W,null,K(l(f),(i,C)=>(m(),b("tr",{key:C},[e("td",we,_(C+1),1),e("td",null,[x(_(i.activity)+" ",1),i.meeting_link?(m(),b("small",be,[x(" | "),e("a",{href:i.meeting_link,target:"_blank",class:"me-2"},[t(g,{icon:"ri ri-link"}),x(" Join Now ")],8,ke)])):U("",!0)]),e("td",De,_(i.description),1),e("td",null,_(r.$moment(i.start_date).format("MMM Do YYYY")),1),e("td",$e,_(i.start_time),1),e("td",Ce,[F(e("input",{type:"time",class:"form-control px-2 py-2 border rounded cursor-pointer","onUpdate:modelValue":N=>i.end_time=N,onChange:N=>l(a)(i),disabled:i.start_time=="00:00"||i.cutoff_status=="completed"},null,40,Te),[[te,i.end_time],[L,i.cutoff_status=="completed"?"Already Cut-Off":"End Time","start"]])]),e("td",Me,_(i.estimate)+" Minutes",1),e("td",null,[F(t(re,{color:"success",modelValue:i.status,"onUpdate:modelValue":[N=>i.status=N,N=>y(i)],value:"1","false-value":0,disabled:i.start_time=="00:00"||i.cutoff_status=="completed"},null,8,["modelValue","onUpdate:modelValue","disabled"]),[[L,i.status?"Completed":"Not Yet","start"]])]),p.require=="mentor"?(m(),b("td",Se,[F((m(),D(z,{color:"error",density:"compact",disabled:i.start_time=="00:00"||i.cutoff_status=="completed",onClick:N=>v("delete",i)},{default:s(()=>[t(g,{icon:"ri-delete-bin-line",class:"cursor-pointer"})]),_:2},1032,["disabled","onClick"])),[[L,i.status?"Already Cut-Off":"Delete Activity","start"]])])):U("",!0)]))),128))])]),_:1}))]),_:1}),t(Z,{modelValue:l(d).delete,"onUpdate:modelValue":u[4]||(u[4]=i=>l(d).delete=i),"max-width":"400",persistent:""},{default:s(()=>[t(ae,{title:"activity",onClose:u[3]||(u[3]=i=>o("delete")),onDelete:n})]),_:1},8,["modelValue"])]),_:1}))}},Ae={class:"w-100"},Pe={class:"mt-3 font-weight-light"},Ye=e("hr",{class:"my-2"},null,-1),Ue={key:0},qe=e("tr",{class:"bg-secondary"},[e("td",null,"Name"),e("td",null,"School"),e("td",null,"Grade")],-1),Be={key:1},je=e("td",{width:"20%"},"Name",-1),Fe=e("td",{width:"1%"},":",-1),Le=e("td",null,"School Name",-1),ze=e("td",{width:"1%"},":",-1),Ee=e("td",null,"Grade",-1),Re=e("td",{width:"1%"},":",-1),Ie=e("td",null,"Email",-1),Oe=e("td",{width:"1%"},":",-1),Ge={class:"mt-5 font-weight-light"},Je=e("hr",{class:"my-2"},null,-1),We=e("td",{width:"20%"},"Program",-1),Xe=e("td",{width:"1%"},":",-1),Ze=e("td",null,"Package",-1),He=e("td",{width:"1%"},":",-1),Ke=e("td",null,"Person in Charge",-1),Qe=e("td",{width:"1%"},":",-1),et={class:"ms-4",type:"1"},tt=e("td",null,"Tutor/Mentor",-1),lt=e("td",{width:"1%"},":",-1),st=e("td",null,"Update On",-1),at=e("td",{width:"1%"},":",-1),ot={class:"d-flex align-end w-100"},nt={class:"m-0 mb-1 text-white"},it=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),dt={class:"text-end w-100"},rt={class:"d-flex align-end w-100"},ct={class:"m-0 mb-1 text-white"},ut=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),_t={class:"text-end w-100"},mt={class:"d-flex align-end w-100"},pt={class:"m-0 mb-1 text-white"},ft=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),ht={class:"text-end w-100"},vt={__name:"user-detail",props:{id:String},setup(M){const p=M,V=O("reloadData"),f=O("updateReload"),c=$([]),d=$(!1),S=async h=>{var o,v,n;d.value=!0;try{const a=await A.get("api/v1/timesheet/"+h+"/detail");a&&(c.value=a)}catch(a){((o=a.response)==null?void 0:o.status)==400&&(T("error",(n=(v=a.response)==null?void 0:v.data)==null?void 0:n.errors,"bottom-end"),se.push("/admin/timesheet")),console.log(a)}finally{d.value=!1}};return H(()=>{S(p.id)}),le(()=>{V.value&&(S(p.id),f(!1))}),(h,o)=>{const v=R("router-link");return m(),D(P,{class:"mb-3"},{default:s(()=>[t(q,{class:"d-flex justify-between align-center"},{default:s(()=>{var n;return[e("div",Ae,[t(v,{to:"/user/timesheet"},{default:s(()=>[t(g,{icon:"ri-arrow-left-line",color:"secondary",class:"me-2",size:"25"})]),_:1}),x(" Timesheet - "+_((n=l(c).packageDetails)==null?void 0:n.package_type),1)])]}),_:1}),t(k,null,{default:s(()=>[l(d)?(m(),D(G,{key:1},{default:s(()=>[t(w,{md:"7"},{default:s(()=>[t(B,{type:"heading, paragraph, heading, paragraph",class:"mb-3"})]),_:1}),t(w,{md:"5"},{default:s(()=>[t(B,{type:"text@3",color:"#16B1FF",class:"mb-3"}),t(B,{type:"text@3",color:"#91c45e",class:"mb-3"}),t(B,{type:"text@3",color:"#e05e5e",class:"mb-3"})]),_:1})]),_:1})):(m(),D(G,{key:0,align:"center"},{default:s(()=>[t(w,{md:"7"},{default:s(()=>[e("h4",Pe,[t(g,{icon:"ri-user-line",size:"17",class:"me-2"}),x(" Basic Profile ")]),Ye,t(J,{density:"compact"},{default:s(()=>{var n,a;return[((n=l(c).clientProfile)==null?void 0:n.length)>1?(m(),b("tbody",Ue,[qe,(m(!0),b(W,null,K(l(c).clientProfile,y=>(m(),b("tr",null,[e("td",null,_(y.client_name),1),e("td",null,_(y.client_school),1),e("td",null,_(y.client_grade),1)]))),256))])):((a=l(c).clientProfile)==null?void 0:a.length)==1?(m(),b("tbody",Be,[e("tr",null,[je,Fe,e("td",null,_(l(c).clientProfile[0].client_name),1)]),e("tr",null,[Le,ze,e("td",null,_(l(c).clientProfile[0].client_school),1)]),e("tr",null,[Ee,Re,e("td",null,_(l(c).clientProfile[0].client_grade),1)]),e("tr",null,[Ie,Oe,e("td",null,_(l(c).clientProfile[0].client_mail),1)])])):U("",!0)]}),_:1}),e("h4",Ge,[t(g,{icon:"ri-bookmark-line",class:"me-2",size:"17"}),x(" Package Details ")]),Je,t(J,{density:"compact"},{default:s(()=>{var n,a,y,r,u;return[e("tbody",null,[e("tr",null,[We,Xe,e("td",null,_((n=l(c).packageDetails)==null?void 0:n.program_name),1)]),e("tr",null,[Ze,He,e("td",null,_(((a=l(c).packageDetails)==null?void 0:a.package_type)+" - "+((y=l(c).packageDetails)==null?void 0:y.package_name)),1)]),e("tr",null,[Ke,Qe,e("td",null,[e("ol",et,[e("li",null,_((r=l(c).packageDetails)==null?void 0:r.pic_name),1)])])]),e("tr",null,[tt,lt,e("td",null,_((u=l(c).packageDetails)==null?void 0:u.tutormentor_name),1)]),e("tr",null,[st,at,e("td",null,_(l(I)().format("LLL")),1)])])]}),_:1})]),_:1}),t(w,{md:"5"},{default:s(()=>[t(P,{color:"#16B1FF",class:"mb-2 d-flex align-center"},{default:s(()=>[e("div",null,[t(E,null,{default:s(()=>[t(q,{class:"text-white"},{default:s(()=>[x(" Total Minutes of Package ")]),_:1})]),_:1}),t(k,{class:"d-flex justify-between"},{default:s(()=>{var n;return[e("div",ot,[e("h1",nt,_((n=l(c).packageDetails)==null?void 0:n.duration_in_minutes),1),it])]}),_:1})]),t(k,null,{default:s(()=>[e("div",dt,[t(g,{icon:"ri-calendar-schedule-line",size:"60"})])]),_:1})]),_:1}),t(P,{color:"#91c45e",class:"mb-2 d-flex align-center"},{default:s(()=>[e("div",null,[t(E,null,{default:s(()=>[t(q,{class:"text-white"},{default:s(()=>[x(" Total Minutes Spent ")]),_:1})]),_:1}),t(k,{class:"d-flex justify-between"},{default:s(()=>{var n;return[e("div",rt,[e("h1",ct,_((n=l(c).packageDetails)==null?void 0:n.time_spent_in_minutes),1),ut])]}),_:1})]),t(k,null,{default:s(()=>[e("div",_t,[t(g,{icon:"ri-timer-flash-line",size:"60",color:"white"})])]),_:1})]),_:1}),t(P,{color:"#e05e5e",class:"mb-2 d-flex align-center"},{default:s(()=>[e("div",null,[t(E,null,{default:s(()=>[t(q,{class:"text-white"},{default:s(()=>[x(" Total Minutes Left ")]),_:1})]),_:1}),t(k,{class:"d-flex justify-between"},{default:s(()=>{var n,a;return[e("div",mt,[e("h1",pt,_(((n=l(c).packageDetails)==null?void 0:n.duration_in_minutes)-((a=l(c).packageDetails)==null?void 0:a.time_spent_in_minutes)),1),ft])]}),_:1})]),t(k,null,{default:s(()=>[e("div",ht,[t(g,{icon:"ri-timer-2-line",size:"60"})])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1})}}},Ut={__name:"timesheet-detail",props:{id:Number,require:String},setup(M){const p=M,V=p.id,f=$(!1);return X("reloadData",f),X("updateReload",c=>{f.value=c}),(c,d)=>(m(),b(W,null,[t(vt,{id:l(V)},null,8,["id"]),t(Ne,{id:l(V),require:p.require},null,8,["id","require"])],64))}};export{Ut as default};
